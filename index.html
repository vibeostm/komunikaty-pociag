<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Komunikaty PKP IC</title>

  <link rel="stylesheet" href="style.css">

  <link rel="icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#ffffff">
</head>
<body>

  <div class="tabs">
    <div id="tabPL" class="tab active">ðŸ‡µðŸ‡± Polski</div>
    <div id="tabEN" class="tab">ðŸ‡¬ðŸ‡§ English</div>
  </div>

  <main class="accordion-container">

    <div id="sectionPL" class="section active">
      <div data-load="pl/komunikat1.html"></div>
      <div data-load="pl/komunikat2.html"></div>
      <div data-load="pl/komunikat3.html"></div>
      <div data-load="pl/komunikat4.html"></div>
      <div data-load="pl/komunikat5.html"></div>
      <div data-load="pl/komunikat6.html"></div>
      <div data-load="pl/komunikat7.html"></div>
      <div data-load="pl/komunikat8.html"></div>
      <div data-load="pl/uwaga.html"></div>
    </div>

    <div id="sectionEN" class="section">
      <div data-load="en/announcement1.html"></div>
      <div data-load="en/announcement2.html"></div>
      <div data-load="en/announcement3.html"></div>
      <div data-load="en/announcement4.html"></div>
      <div data-load="en/announcement5.html"></div>
      <div data-load="en/announcement6.html"></div>
      <div data-load="en/announcement7.html"></div>
      <div data-load="en/announcement8.html"></div>
      <div data-load="en/note.html"></div>
    </div>

  </main>

  <footer id="gc-footer" style="text-align:center; padding:10px 0 14px; font-size:0.85rem; opacity:0.95;">
    <div style="display:inline-flex; flex-wrap:wrap; gap:6px; justify-content:center; align-items:center; border:1px solid #ddd; border-radius:12px; padding:8px 10px; max-width:92vw;">
      <span style="font-weight:700; white-space:nowrap;">OdsÅ‚ony:</span>

      <span style="border:1px solid #e5e5e5; border-radius:10px; padding:4px 8px; white-space:nowrap;">
        Å‚Ä…cznie <span id="gc-total">â€“</span>
      </span>

      <span style="border:1px solid #e5e5e5; border-radius:10px; padding:4px 8px; white-space:nowrap;">
        dziÅ› <span id="gc-today">â€“</span>
      </span>

      <span style="border:1px solid #e5e5e5; border-radius:10px; padding:4px 8px; white-space:nowrap;">
        ostatnie 7 dni <span id="gc-7d">â€“</span>
      </span>
    </div>
  </footer>

  <!-- PÅYWAJÄ„CY PRZEÅÄ„CZNIK JÄ˜ZYKA (PL/EN) -->
  <button id="langFab" class="lang-fab" type="button" aria-label="PrzeÅ‚Ä…cz jÄ™zyk">EN</button>

  <script src="script.js"></script>

  <script data-goatcounter="https://komunikaty.goatcounter.com/count"
          async src="//gc.zgo.at/count.js"></script>

  <script>
    const GC = "https://komunikaty.goatcounter.com";

    function ymd(d) {
      const pad = (n) => String(n).padStart(2, "0");
      return d.getFullYear() + "-" + pad(d.getMonth()+1) + "-" + pad(d.getDate());
    }

    async function gcCount(path, start=null, end=null) {
      const p = encodeURIComponent(path);
      let url = `${GC}/counter/${p}.json`;
      const qs = [];
      if (start) qs.push(`start=${encodeURIComponent(start)}`);
      if (end)   qs.push(`end=${encodeURIComponent(end)}`);
      qs.push(`_=${Date.now()}`); // cache-buster
      url += `?${qs.join("&")}`;

      const r = await fetch(url, {cache: "no-store"});
      if (!r.ok) throw new Error("GoatCounter HTTP " + r.status);
      const data = await r.json();
      return data.count;
    }

    (async () => {
      try {
        const today = new Date();
        const startToday = ymd(today);

        document.getElementById("gc-total").textContent = await gcCount("TOTAL");
        document.getElementById("gc-today").textContent = await gcCount("TOTAL", startToday);

        const d7 = new Date(today);
        d7.setDate(d7.getDate() - 7);
        document.getElementById("gc-7d").textContent = await gcCount("TOTAL", ymd(d7));
      } catch (e) {
        console.warn("GoatCounter counter failed:", e);
      }
    })();
  </script>

</body>
</html>
